<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guia Cerrado – Editorial</title>

  <!-- Supabase UMD v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #000;
      color: #fff;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, #0b0f1a, #020615);
      padding: 14px 32px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .left img {
      width: 48px;
      height: auto;
    }

    .text h1 {
      font-size: 16px;
      font-weight: 700;
      margin: 0;
    }

    .text p {
      font-size: 14px;
      color: #a0a0a0;
      margin: 0;
    }

    .btn-voltar {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: #fff;
      padding: 8px 14px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s ease-in-out;
    }

    .btn-voltar:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.04);
    }

    /* --- Seção dos botões principais --- */
    .menu-section {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      padding: 40px 0 24px;
      background: linear-gradient(to bottom, #020617, #000);
    }

    .menu-btn {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #fff;
      font-size: 15px;
      padding: 14px 32px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .menu-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: scale(1.05);
    }

    /* --- Lista de restaurantes --- */
    .restaurantes {
      display: none; /* começa oculta */
      flex-wrap: wrap;
      justify-content: center;
      gap: 24px;
      padding: 12px 40px 60px;
      background: #000;
    }

    .card {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 16px;
      padding: 18px 20px;
      width: 280px;
      text-align: left;
      transition: all 0.3s ease;
    }

    .card:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-3px);
    }

    .card h2 {
      font-size: 18px;
      margin: 0 0 6px;
    }

    .card p {
      font-size: 14px;
      color: #aaa;
      margin: 0 0 4px;
    }

    .card .resenha {
      margin-top: 6px;
      font-size: 13px;
      color: #c5c5c5;
    }

    .card a {
      display: inline-block;
      color: #d4af37;
      font-size: 14px;
      text-decoration: none;
      margin-top: 6px;
    }

    .card a:hover {
      text-decoration: underline;
    }

    .status {
      width: 100%;
      text-align: center;
      font-size: 14px;
      color: #9ca3af;
      margin-top: 8px;
    }
  </style>
</head>
<body>

  <header>
    <div class="left">
      <img src="../recursos/logo.png" alt="Logo Guia Cerrado">
      <div class="text">
        <h1>Bem-vindo, Membro</h1>
        <p>Escolha onde será sua próxima experiência no Cerrado.</p>
      </div>
    </div>
    <button class="btn-voltar" onclick="window.location.href='../index.html'">
      ← Página principal
    </button>
  </header>

  <section class="menu-section">
    <button class="menu-btn" onclick="toggleRestaurantes()">Menu de Restaurantes</button>
    <button class="menu-btn" onclick="window.location.href='meu-almoco.html'">Meu Almoço</button>
  </section>

  <div id="status" class="status"></div>

  <section id="listaRestaurantes" class="restaurantes">
    <!-- cards serão inseridos via JS -->
  </section>

  <script>
    // --- Inicialização Supabase ---
    const SUPABASE_URL = 'https://kgppqiqnxwxemqyrlfum.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_lFw3tfDJap3R8HvO2Gv14w_1BGA-nYQ';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let restaurantesCarregados = false;

    async function carregarRestaurantes() {
      const statusEl = document.getElementById('status');
      const container = document.getElementById('listaRestaurantes');
      statusEl.textContent = 'Carregando restaurantes...';

      const { data, error } = await supabase
        .from('restaurantes')
        .select('nome, endereco, telefone, links_mapas, resenha')
        .order('nome', { ascending: true });

      if (error) {
        console.error(error);
        statusEl.textContent = 'Não foi possível carregar os restaurantes.';
        return;
      }

      container.innerHTML = '';

      if (!data || data.length === 0) {
        statusEl.textContent = 'Ainda não há restaurantes cadastrados.';
        return;
      }

      data.forEach(rest => {
        const card = document.createElement('div');
        card.className = 'card';

        const nome = document.createElement('h2');
        nome.textContent = rest.nome || 'Restaurante';

        const endereco = document.createElement('p');
        endereco.textContent = rest.endereco || 'Endereço não informado';

        card.appendChild(nome);
        card.appendChild(endereco);

        if (rest.telefone) {
          const tel = document.createElement('p');
          tel.textContent = 'Telefone: ' + rest.telefone;
          card.appendChild(tel);
        }

        if (rest.resenha) {
          const resenha = document.createElement('p');
          resenha.className = 'resenha';
          resenha.textContent = rest.resenha;
          card.appendChild(resenha);
        }

        if (rest.links_mapas) {
          const link = document.createElement('a');
          link.href = rest.links_mapas;
          link.target = '_blank';
          link.rel = 'noopener noreferrer';
          link.textContent = 'Ver no mapa';
          card.appendChild(link);
        }

        container.appendChild(card);
      });

      statusEl.textContent = '';
      restaurantesCarregados = true;
    }

    function toggleRestaurantes() {
      const lista = document.getElementById('listaRestaurantes');

      if (!restaurantesCarregados) {
        carregarRestaurantes().then(() => {
          lista.style.display = 'flex';
        });
      } else {
        // apenas alterna visibilidade
        lista.style.display = (lista.style.display === 'flex') ? 'none' : 'flex';
      }
    }
  </script>

</body>
</html>
